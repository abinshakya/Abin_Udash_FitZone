{% extends 'base.html' %}

{% block content %}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
</style>

{% if messages %}
  <div class="fz-alert-wrap">
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }}">{{ message }}</div>
    {% endfor %}
  </div>
{% endif %}

<div class="page-wrapper">
  <div class="form-container">
    <div class="form-card">

      <div class="form-header">
        <div>
          <h2 class="form-title">
            <i class="fa-solid fa-user-check" style="color:var(--orange)"></i>
            Trainer Registration
          </h2>
          <p class="form-subtitle">Fill in your details and upload documents to become a FitZone trainer.</p>
        </div>

        <span class="secure-pill">
          <i class="fa-solid fa-shield-halved"></i> Verified Trainers
        </span>
      </div>

      <div class="form-body">
        <form method="post" enctype="multipart/form-data">
          {% csrf_token %}

          <div class="grid-2">
            <div class="form-group">
              <label for="experience">Experience (years)</label>
              <input type="number" id="experience" name="experience" min="0" placeholder="e.g. 3" required>
              <div class="help">Enter total years of professional training experience.</div>
            </div>

            <div class="form-group">
              <label for="specialization">Area of Expertise / Specialization</label>
              <input type="text" id="specialization" name="specialization"
                     placeholder="e.g. Strength Training, Yoga, Cardio" required>
              <div class="help">Add your main training categories (comma separated).</div>
            </div>
          </div>

          <div class="grid-2">
            <!-- Certification -->
            <div class="file-block" id="block-certification">
              <div class="file-head">
                <label for="certification" style="margin:0;">Certification</label>
                <span class="file-tag"><i class="fa-solid fa-file"></i> PDF / Images</span>
              </div>

              <input type="file" id="certification" name="certification" accept="image/*,application/pdf" multiple>

              <div class="file-ui">
                <label class="file-btn" for="certification">
                  <i class="fa-solid fa-arrow-up-from-bracket"></i> Choose Files
                </label>
                <div class="file-name" id="name-certification">No files selected</div>
              </div>

              <div class="preview-grid" id="preview-certification"></div>
              <div class="help">Upload certificate images or PDF files (multiple allowed).</div>
            </div>

            <!-- Profile Pictures -->
            <div class="file-block" id="block-profile_pic">
              <div class="file-head">
                <label for="profile_pic" style="margin:0;">Profile Pictures</label>
                <span class="file-tag"><i class="fa-solid fa-image"></i> Images</span>
              </div>

              <input type="file" id="profile_pic" name="profile_pic" accept="image/*" multiple>

              <div class="file-ui">
                <label class="file-btn" for="profile_pic">
                  <i class="fa-solid fa-camera"></i> Choose Images
                </label>
                <div class="file-name" id="name-profile_pic">No files selected</div>
              </div>

              <div class="preview-grid" id="preview-profile_pic"></div>
              <div class="help">Upload multiple images (we’ll use the best as your main photo).</div>
            </div>
          </div>

          <div class="grid-2">
            <!-- Identity Proof -->
            <div class="file-block" id="block-identity_proof">
              <div class="file-head">
                <label for="identity_proof" style="margin:0;">Identity Proof</label>
                <span class="file-tag"><i class="fa-solid fa-id-card"></i> PDF / Images</span>
              </div>

              <input type="file" id="identity_proof" name="identity_proof" accept="image/*,application/pdf" multiple>

              <div class="file-ui">
                <label class="file-btn" for="identity_proof">
                  <i class="fa-solid fa-id-card"></i> Choose Files
                </label>
                <div class="file-name" id="name-identity_proof">No files selected</div>
              </div>

              <div class="preview-grid" id="preview-identity_proof"></div>
              <div class="help">Upload government-issued ID (multiple allowed).</div>
            </div>

            <!-- Experience Verification -->
            <div class="file-block" id="block-experience_verification">
              <div class="file-head">
                <label for="experience_verification" style="margin:0;">Experience Verification</label>
                <span class="file-tag"><i class="fa-solid fa-briefcase"></i> PDF / Images</span>
              </div>

              <input type="file" id="experience_verification" name="experience_verification" accept="image/*,application/pdf" multiple>

              <div class="file-ui">
                <label class="file-btn" for="experience_verification">
                  <i class="fa-solid fa-file-signature"></i> Choose Files
                </label>
                <div class="file-name" id="name-experience_verification">No files selected</div>
              </div>

              <div class="preview-grid" id="preview-experience_verification"></div>
              <div class="help">Upload experience letter or documents (multiple allowed).</div>
            </div>
          </div>

          <div class="form-group">
            <label for="bio">Short Bio</label>
            <textarea id="bio" name="bio" rows="4" placeholder="Tell clients about your style, certifications, and specialties..."></textarea>
            <div class="help">Keep it short and professional (2–4 lines).</div>
          </div>

          <div class="form-actions">
            <button type="submit" class="submit-btn">
              Submit Registration <span style="font-weight:900;">→</span>
            </button>
            <p class="fineprint">
              By submitting, you confirm all information is accurate. FitZone may verify documents before approval.
            </p>
          </div>
        </form>
      </div>

    </div>
  </div>
</div>

<script>
  function attachMultiFileUI(inputId) {
    const input = document.getElementById(inputId);
    const nameEl = document.getElementById(`name-${inputId}`);
    const previewGrid = document.getElementById(`preview-${inputId}`);
    if (!input || !nameEl || !previewGrid) return;

    input.addEventListener("change", () => {
      const files = Array.from(input.files || []);
      previewGrid.innerHTML = "";

      if (!files.length) {
        nameEl.textContent = "No files selected";
        return;
      }

      nameEl.textContent = files.length === 1 ? files[0].name : `${files.length} files selected`;

      files.forEach((file) => {
        if (file.type && file.type.startsWith("image/")) {
          const url = URL.createObjectURL(file);
          const wrap = document.createElement("div");
          wrap.className = "thumb";

          const img = document.createElement("img");
          img.src = url;
          img.alt = "Preview";

          wrap.appendChild(img);
          previewGrid.appendChild(wrap);

          img.onload = () => URL.revokeObjectURL(url);
        }
      });
    });
  }

  ["certification", "profile_pic", "identity_proof", "experience_verification"].forEach(attachMultiFileUI);
</script>

{% endblock content %}
